<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notes in the Margins</title>
    <link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,500;1,400&family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --paper: #f6f1e9;
            --ink: #2a2521;
            --faded-ink: #6d6054;
            --margin-ink: #8a7a66;
            --rule: rgba(107, 93, 71, 0.15);
            --highlight-bg: rgba(210, 180, 120, 0.25);
            --highlight-bg-hover: rgba(210, 180, 120, 0.45);
            --highlight-border: rgba(190, 160, 90, 0.4);
            --highlight-border-hover: rgba(190, 160, 90, 0.7);
        }

        ::selection {
            background: rgba(210, 180, 120, 0.35);
            color: var(--ink);
        }

        ::-moz-selection {
            background: rgba(210, 180, 120, 0.35);
            color: var(--ink);
        }

        /* ── Custom scrollbar ── */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--paper);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(107, 93, 71, 0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(107, 93, 71, 0.35);
        }

        html {
            scrollbar-width: thin;
            scrollbar-color: rgba(107, 93, 71, 0.2) var(--paper);
        }

        body {
            font-family: 'Lora', serif;
            background: var(--paper);
            color: var(--ink);
            line-height: 1.8;
            font-size: 17px;
            min-height: 100vh;
        }

        /* ── Paper texture ── */
        body::before {
            content: '';
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 9999;
            opacity: 0.028;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E");
            background-size: 256px 256px;
        }

        /* ── Layout ── */
        .page {
            max-width: 1360px;
            margin: 0 auto;
            padding: 45px 40px 120px;
            display: grid;
            grid-template-columns: 260px 1fr 320px;
            gap: 70px;
            position: relative;
        }

        /* ── Left column ── */
        .left-column {
            align-self: start;
            position: sticky;
            top: 40px;
        }

        .sidebar-card {
            padding: 24px;
            border-radius: 2px;
            border: 1px solid var(--rule);
        }

        .sidebar-title {
            font-family: 'Crimson Text', serif;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2.5px;
            margin-bottom: 18px;
            color: var(--margin-ink);
        }

        .sidebar-text {
            font-family: 'Crimson Text', serif;
            font-size: 0.92rem;
            line-height: 1.75;
            color: var(--faded-ink);
        }

        .sidebar-text p {
            margin-bottom: 12px;
        }

        .sidebar-text p:last-child {
            margin-bottom: 0;
        }

        /* ── Subscribe ── */
        .subscribe-card { margin-top: 24px; }
        .subscribe-form { margin-top: 14px; }
        .subscribe-input {
            display: block; width: 100%;
            font-family: 'Crimson Text', serif; font-size: 0.9rem;
            color: var(--ink); background: transparent;
            border: 1px solid var(--rule); border-radius: 2px;
            padding: 10px 12px; outline: none;
            transition: border-color 0.25s ease; box-sizing: border-box;
        }
        .subscribe-input::placeholder { color: var(--margin-ink); opacity: 0.6; }
        .subscribe-input:focus { border-color: var(--margin-ink); }
        .subscribe-button {
            display: block; width: 100%; margin-top: 10px;
            font-family: 'Crimson Text', serif; font-size: 0.8rem;
            font-weight: 600; text-transform: uppercase; letter-spacing: 2px;
            color: var(--faded-ink); background: transparent;
            border: 1px solid var(--rule); border-radius: 2px;
            padding: 9px 16px; cursor: pointer;
            transition: color 0.25s ease, border-color 0.25s ease;
        }
        .subscribe-button:hover { color: var(--ink); border-color: var(--margin-ink); }
        .subscribe-status {
            font-family: 'Crimson Text', serif; font-size: 0.82rem;
            margin-top: 10px; color: var(--margin-ink); font-style: italic;
        }
        .subscribe-status:empty { display: none; }
        .subscribe-status.error { color: #a0522d; }
        .mobile-subscribe { display: none; }

        /* ── Mobile about toggle (hidden on desktop) ── */
        .mobile-about {
            display: none;
        }

        .about-toggle {
            font-family: 'Crimson Text', serif;
            font-size: 0.85rem;
            color: var(--margin-ink);
            background: none;
            border: none;
            cursor: pointer;
            letter-spacing: 1px;
            text-transform: uppercase;
            padding: 0;
            transition: color 0.2s;
        }

        .about-toggle:hover {
            color: var(--ink);
        }

        .about-toggle::after {
            content: ' +';
            font-size: 0.9em;
        }

        .about-toggle.open::after {
            content: ' \2212';
        }

        .mobile-about-body {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease, opacity 0.3s ease;
            opacity: 0;
        }

        .mobile-about-body.open {
            max-height: 400px;
            opacity: 1;
        }

        .mobile-about-text {
            font-family: 'Crimson Text', serif;
            font-size: 0.9rem;
            line-height: 1.75;
            color: var(--faded-ink);
            padding-top: 16px;
        }

        .mobile-about-text p {
            margin-bottom: 10px;
        }

        .mobile-about-text p:last-child {
            margin-bottom: 0;
        }

        /* ── Right column ── */
        .right-column {
            position: relative;
        }

        /* ── Currently reading indicator ── */
        .reading-indicator {
            position: sticky;
            top: 80px;
            font-family: 'Crimson Text', serif;
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .reading-indicator.visible {
            opacity: 1;
        }

        .reading-indicator-label {
            font-size: 0.75rem;
            color: var(--margin-ink);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 12px;
        }

        .reading-indicator-title {
            font-family: 'Libre Baskerville', serif;
            font-size: 1rem;
            color: var(--ink);
            line-height: 1.45;
            margin-bottom: 8px;
        }

        .reading-indicator-progress {
            margin-top: 14px;
            height: 1px;
            background: var(--rule);
            position: relative;
            overflow: hidden;
        }

        .reading-indicator-bar {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 0%;
            background: var(--margin-ink);
            transition: width 0.15s linear;
        }

        /* ── Main content ── */
        .main-content {
            max-width: 640px;
            position: relative;
        }

        /* ── Header ── */
        header {
            margin-bottom: 50px;
            padding-bottom: 30px;
            border-bottom: 1px solid var(--ink);
        }

        .site-title {
            font-family: 'Libre Baskerville', serif;
            font-size: 2.6rem;
            font-weight: 400;
            margin-bottom: 10px;
            letter-spacing: 0.3px;
            line-height: 1.2;
        }

        .site-subtitle {
            font-family: 'Crimson Text', serif;
            font-size: 1.05rem;
            color: var(--faded-ink);
            letter-spacing: 0.3px;
            font-style: italic;
        }

        .visitor-count {
            font-family: 'Crimson Text', serif;
            font-size: 0.78rem;
            color: var(--margin-ink);
            margin-top: 8px;
            letter-spacing: 0.3px;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .visitor-count.loaded {
            opacity: 1;
        }

        /* ── Entries ── */
        .entry {
            margin-bottom: 0;
            padding: 60px 0;
            position: relative;
            scroll-margin-top: 60px;
            border-bottom: 1px solid var(--rule);
        }

        .entry:last-child {
            border-bottom: none;
        }

        .entry-meta {
            font-family: 'Crimson Text', serif;
            font-size: 0.82rem;
            color: var(--margin-ink);
            margin-bottom: 14px;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            display: inline-block;
            border-bottom: 1px solid var(--rule);
            padding-bottom: 3px;
        }



        .entry-title {
            font-family: 'Libre Baskerville', serif;
            font-size: 1.55rem;
            font-weight: 400;
            margin-bottom: 26px;
            line-height: 1.45;
            letter-spacing: 0.2px;
            cursor: pointer;
            position: relative;
        }

        .entry-title::before {
            content: '\00a7';
            position: absolute;
            left: -1.4em;
            opacity: 0;
            color: var(--margin-ink);
            font-size: 0.85em;
            transition: opacity 0.25s ease;
        }

        .entry-title:hover::before {
            opacity: 0.45;
        }

        .link-tooltip {
            position: absolute;
            left: 0;
            top: 100%;
            margin-top: 2px;
            font-family: 'Crimson Text', serif;
            font-size: 0.78rem;
            color: var(--margin-ink);
            letter-spacing: 0.5px;
            font-style: italic;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            white-space: nowrap;
        }

        .link-tooltip.show {
            opacity: 1;
        }

        /* Mobile: fixed toast at bottom of viewport */
        .link-toast {
            position: fixed;
            left: 50%;
            bottom: 32px;
            transform: translateX(-50%);
            font-family: 'Crimson Text', serif;
            font-size: 0.82rem;
            letter-spacing: 0.5px;
            font-style: italic;
            color: var(--paper);
            background: var(--ink);
            padding: 8px 22px;
            border-radius: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
            white-space: nowrap;
            z-index: 10001;
        }

        .link-toast.show {
            opacity: 1;
        }

        .entry-body {
            font-size: 1.02rem;
            line-height: 1.95;
        }

        .entry-body p {
            margin-bottom: 1.5em;
        }

        .entry-body p:last-child {
            margin-bottom: 0;
        }

        /* ── Drop caps ── */
        .entry-body > p:first-child::first-letter {
            font-family: 'Libre Baskerville', serif;
            font-size: 3.4em;
            float: left;
            line-height: 0.78;
            padding-right: 8px;
            padding-top: 5px;
            color: var(--ink);
        }

        /* ── Annotations ── */
        .annotated {
            background: var(--highlight-bg);
            padding: 1px 3px;
            border-bottom: 1.5px solid var(--highlight-border);
            cursor: pointer;
            transition: background 0.2s, border-color 0.2s;
            position: relative;
        }

        .annotated:hover {
            background: var(--highlight-bg-hover);
            border-bottom-color: var(--highlight-border-hover);
        }

        /* ── Popup tooltip (for mobile / click) ── */
        .note-popup {
            position: absolute;
            bottom: calc(100% + 10px);
            left: 50%;
            transform: translateX(-50%);
            width: 280px;
            background: var(--paper);
            border: 1px solid var(--rule);
            border-radius: 3px;
            padding: 14px 16px;
            box-shadow: 0 4px 20px rgba(42, 37, 33, 0.1);
            font-family: 'Crimson Text', serif;
            font-size: 0.88rem;
            line-height: 1.65;
            color: var(--faded-ink);
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.25s ease, transform 0.25s ease;
            transform: translateX(-50%) translateY(4px);
        }

        .note-popup.show {
            opacity: 1;
            pointer-events: auto;
            transform: translateX(-50%) translateY(0);
        }

        /* Arrow pointing down from popup */
        .note-popup::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-top-color: var(--paper);
        }

        .note-popup::before {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 7px solid transparent;
            border-top-color: var(--rule);
        }

        .note-popup-label {
            font-weight: 600;
            color: var(--margin-ink);
            margin-bottom: 4px;
            font-size: 0.78rem;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .note-popup a {
            color: var(--margin-ink);
            text-decoration: none;
            border-bottom: 1px solid var(--rule);
        }

        /* Flip popup below if near top of viewport */
        .note-popup.below {
            bottom: auto;
            top: calc(100% + 10px);
            transform: translateX(-50%) translateY(-4px);
        }

        .note-popup.below.show {
            transform: translateX(-50%) translateY(0);
        }

        .note-popup.below::after {
            top: auto;
            bottom: 100%;
            border-top-color: transparent;
            border-bottom-color: var(--paper);
        }

        .note-popup.below::before {
            top: auto;
            bottom: 100%;
            border-top-color: transparent;
            border-bottom-color: var(--rule);
        }

        /* ── Margin notes (desktop) ── */
        .margin-note {
            font-family: 'Crimson Text', serif;
            font-size: 0.88rem;
            line-height: 1.65;
            color: var(--faded-ink);
            padding: 14px 0 14px 18px;
            border-left: 2px solid var(--rule);
            position: absolute;
            right: -390px;
            width: 300px;
            opacity: 0;
            transform: translateX(6px);
            transition: opacity 0.35s ease, transform 0.35s ease;
            pointer-events: none;
        }

        .margin-note.visible {
            opacity: 1;
            transform: translateX(0);
            pointer-events: auto;
        }

        .margin-note-label {
            font-weight: 600;
            color: var(--margin-ink);
            margin-bottom: 4px;
            font-size: 0.8rem;
            font-family: 'Crimson Text', serif;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .margin-note a {
            color: var(--margin-ink);
            text-decoration: none;
            border-bottom: 1px solid var(--rule);
            transition: border-color 0.2s;
        }

        .margin-note a:hover {
            border-bottom-color: var(--ink);
        }

        /* ── Blockquotes ── */
        blockquote {
            margin: 2em 0;
            padding: 0 0 0 24px;
            border-left: 2px solid var(--margin-ink);
            color: var(--faded-ink);
            font-style: italic;
        }

        blockquote p {
            margin-bottom: 1em;
        }

        blockquote p:last-child {
            margin-bottom: 0;
        }

        .citation {
            font-family: 'Crimson Text', serif;
            font-size: 0.82rem;
            color: var(--margin-ink);
            font-style: italic;
            margin-top: -1.5em;
            margin-bottom: 2em;
        }

        /* ── Essay figure ── */
        .essay-figure {
            margin: 2em auto 2.5em;
            max-width: 320px;
            text-align: center;
        }
        .essay-figure img {
            width: 100%;
            height: auto;
            border-radius: 2px;
            box-shadow: 0 2px 12px rgba(42, 37, 33, 0.12);
        }
        .essay-figure figcaption {
            font-family: 'Crimson Text', serif;
            font-size: 0.78rem;
            color: var(--margin-ink);
            font-style: italic;
            margin-top: 0.6em;
            line-height: 1.4;
        }

        /* ── Entry number ── */
        .entry-number {
            font-family: 'Crimson Text', serif;
            font-size: 0.82rem;
            color: var(--margin-ink);
            letter-spacing: 0.5px;
            font-weight: 600;
            margin-right: 8px;
        }

        /* ── Reading progress ── */
        .reading-progress {
            position: fixed;
            top: 0;
            left: 0;
            height: 2px;
            width: 0%;
            background: linear-gradient(90deg, var(--highlight-border), var(--margin-ink));
            z-index: 10000;
            transition: width 0.08s linear;
            pointer-events: none;
        }

        .site-footer {
            padding-top: 40px;
            font-family: 'Crimson Text', serif;
            font-size: 0.85rem;
            color: var(--margin-ink);
            font-style: italic;
        }

        /* ── Responsive ── */
        @media (max-width: 1200px) {
            .page {
                grid-template-columns: 1fr;
                max-width: 640px;
                gap: 0;
                padding: 50px 28px 80px;
            }

            .left-column {
                display: none;
            }

            .mobile-about {
                display: block;
                margin-top: 18px;
            }

            .right-column {
                display: none;
            }

            /* On mobile/tablet, margin notes are hidden — popups replace them */
            .margin-note {
                display: none;
            }

            header {
                margin-bottom: 50px;
                padding-bottom: 30px;
            }

            .entry-title::before {
                display: none;
            }

            .mobile-subscribe {
                display: block; margin-top: 16px;
                padding-top: 16px; border-top: 1px solid var(--rule);
            }
            .mobile-subscribe-row { display: flex; gap: 10px; }
            .mobile-subscribe-row .subscribe-input { flex: 1; min-width: 0; }
            .mobile-subscribe-row .subscribe-button {
                margin-top: 0; width: auto; white-space: nowrap; padding: 10px 18px;
            }
        }

        @media (max-width: 600px) {
            .page {
                padding: 36px 20px 60px;
            }

            .site-title {
                font-size: 1.9rem;
            }

            .site-subtitle {
                font-size: 0.95rem;
            }

            .entry-title {
                font-size: 1.3rem;
            }

            .entry {
                padding: 36px 0;
            }

            .entry-body {
                font-size: 0.98rem;
            }

            .entry-body > p:first-child::first-letter {
                font-size: 2.8em;
                padding-right: 6px;
                padding-top: 4px;
            }

            .note-popup {
                width: 240px;
                font-size: 0.85rem;
                padding: 12px 14px;
            }
        }

        /* ── Print ── */
        @media print {
            body {
                font-size: 12pt;
                background: white;
                color: black;
            }

            body::before {
                display: none;
            }

            .reading-progress,
            .left-column,
            .right-column,
            .mobile-about,
            .margin-note,
            .subscribe-card,
            .mobile-subscribe {
                display: none !important;
            }

            .page {
                display: block;
                max-width: none;
                padding: 0;
            }

            .main-content {
                max-width: none;
            }

            header {
                margin-bottom: 2em;
                padding-bottom: 1em;
            }

            .site-title {
                font-size: 1.8rem;
            }

            .entry {
                page-break-inside: avoid;
                padding: 2em 0;
            }

            .entry-title {
                cursor: default;
            }

            .entry-title::before {
                display: none;
            }

            .annotated {
                background: none;
                border-bottom: none;
                cursor: default;
            }

            .note-popup {
                display: none;
            }

            a[href^="#"] {
                color: inherit;
                text-decoration: none;
                border-bottom: none;
            }

            .site-footer {
                font-size: 0.8rem;
                border-top: 1px solid #ccc;
                padding-top: 1em;
            }
        }
    </style>
</head>
<body>
    <div class="reading-progress" id="readingProgress"></div>
    <div class="page">
        <!-- Left column (desktop only) -->
        <aside class="left-column">
            <div class="sidebar-card">
                <h3 class="sidebar-title">About</h3>
                <div class="sidebar-text">
                    <p>The journal of a seventeen-year-old student, with three aims:</p>
                    <p>To learn what it means to be human. To test himself against questions he's still figuring out. To offer something to fellow travellers.</p>
                    <p>Think of these entries as little essays&mdash;from the French <em>essai</em>, a trial, a test of how one responds to a subject.</p>
                    <p>If you wonder about things and want to learn, you are welcome here.</p>
                </div>
            </div>
            <div class="sidebar-card subscribe-card">
                <h3 class="sidebar-title">Subscribe</h3>
                <div class="sidebar-text"><p>Receive new entries by email.</p></div>
                <form action="https://script.google.com/macros/s/AKfycbxys2VXQn-OXvE4YMcAdpMfPL3hd1VUKmz6KddfXzQ4AHa_VElxuPURkKWwaZ9wYqEc/exec" method="POST" class="subscribe-form">
                    <input type="email" name="Email" placeholder="your@email.com"
                           required class="subscribe-input" aria-label="Email address">
                    <button type="submit" class="subscribe-button">Subscribe</button>
                    <div class="subscribe-status" aria-live="polite"></div>
                </form>
            </div>
        </aside>

        <!-- Main content -->
        <main class="main-content">
            <header>
                <h1 class="site-title">Notes in the Margins</h1>
                <div class="site-subtitle">A journal of small essays on large things</div>
                <div class="visitor-count" id="visitorCount"></div>
                <!-- Mobile about: collapsible, lives under the header -->
                <div class="mobile-about">
                    <button class="about-toggle" id="aboutToggle">About this journal</button>
                    <div class="mobile-about-body" id="aboutBody">
                        <div class="mobile-about-text">
                            <p>The journal of a seventeen-year-old student, with three aims:</p>
                            <p>To learn what it means to be human. To test himself against questions he's still figuring out. To offer something to fellow travellers.</p>
                            <p>Think of these entries as little essays&mdash;from the French <em>essai</em>, a trial, a test of how one responds to a subject.</p>
                            <p>If you wonder about things and want to learn, you are welcome here.</p>
                        </div>
                    </div>
                    <div class="mobile-subscribe">
                        <form action="https://script.google.com/macros/s/AKfycbxys2VXQn-OXvE4YMcAdpMfPL3hd1VUKmz6KddfXzQ4AHa_VElxuPURkKWwaZ9wYqEc/exec" method="POST" class="subscribe-form">
                            <div class="mobile-subscribe-row">
                                <input type="email" name="Email" placeholder="your@email.com"
                                       required class="subscribe-input" aria-label="Email address">
                                <button type="submit" class="subscribe-button">Subscribe</button>
                            </div>
                            <div class="subscribe-status" aria-live="polite"></div>
                        </form>
                    </div>
                </div>
            </header>

            <article class="entry" data-date="2026-02-10" id="entry-1">
                <div class="entry-meta"><span class="entry-number">#1</span> 10 February 2026</div>
                <h2 class="entry-title">The glory of folded cloth</h2>
                <div class="entry-body">
                    <p>
                        In <em>The Doors of Perception</em> and <em>Heaven and Hell</em>, English writer and philosopher Aldous Huxley reflects on his experience after taking mescalin, a powerful psychedelic found in cacti, one day in May 1953. I&rsquo;ve only started reading the books, but I&rsquo;m fascinated by what he seems to have seen, and the way he thinks and writes. At one point, after looking at great works of art like Botticelli&rsquo;s <em>Judith</em>, he contemplates how painters and sculptors depict not faces or landscapes, but clothes. In his altered state, he realises that they might seek to represent &ldquo;the unfathomable mystery of pure being.&rdquo;
                    </p>

                    <blockquote>
                        <p>
                            &ldquo;They had seen the <span class="annotated" data-margin="margin-1">Istigkeit</span>, the Allness and Infinity of folded cloth and had done their best to render it in paint or stone. Necessarily, of course, without success. For the glory and the wonder of pure existence belong to another order, beyond the power of even the highest art to express. But in Judith&rsquo;s skirt I could clearly see what, if I had been a painter of genius, I might have made of my old grey flannels. Not much, heaven knows, in comparison with the reality; but enough to delight generation after generation of beholders, enough to make them understand at least a little of the true significance of what, in our pathetic imbecility, we call &lsquo;mere things&rsquo; and disregard in favour of television.&rdquo;
                        </p>
                    </blockquote>
                    <div class="citation">Aldous Huxley, <em>The Doors of Perception</em>, 1954</div>

                    <figure class="essay-figure">
                        <img src="judith-botticelli.jpg"
                             alt="The Return of Judith to Bethulia by Sandro Botticelli, c. 1472"
                             loading="lazy">
                        <figcaption>Sandro Botticelli, <em>The Return of Judith to Bethulia</em>, c. 1472. Uffizi, Florence.</figcaption>
                    </figure>

                    <p>
                        Beyond admiring the fluency of Huxley&rsquo;s prose&mdash;and that final dig at television (wouldn&rsquo;t he be pleased to see us today!)&mdash;this passage made me wonder: can fiction achieve what Huxley describes other artists doing? Can it capture &ldquo;the glory and wonder of pure experience&rdquo;?
                    </p>
                    <p>
                        The problem is that literature seems farther removed from experience than other art forms. When you look at a painting, you might focus on aspects the artist never intended, but you&rsquo;re seeing something close to what they tried to represent. Reading, however, requires you to decode sequences of letters and reconstruct meaning in your mind, adding layers of abstraction between reality and artist, and artist and audience. This seems like a stumbling block when it comes to communicating the immediacy of existence.
                    </p>
                    <p>
                        Still, there must be attempts, even if I&rsquo;m struggling to think of them because I haven&rsquo;t read enough. One example is Joyce&rsquo;s novel <em>Ulysses</em>, a favourite of mine. His young artist character, Stephen Dedalus, experiences moments of <span class="annotated" data-margin="margin-3">epiphany</span>&mdash;&ldquo;a sudden spiritual manifestation, whether in the vulgarity of speech or of gesture or in a memorable phase of the mind itself&rdquo;&mdash;that echo Huxley&rsquo;s insights into reality. But I think that Joyce goes further, and teaches his audience to experience these epiphanies themselves.
                    </p>
                    <p>
                        The 732-page novel chronicles ordinary people going about an ordinary day in Dublin. Nothing remarkable happens&mdash;Joyce devotes pages to a character&rsquo;s thoughts as he sits on the toilet, for example&mdash;but his presentation is extraordinary. Behind every chapter, there lie dozens of references to episodes from Homer&rsquo;s <em>Odyssey</em>, the most grand of narratives. His language does the same: when narrating a woman giving birth, he uses 32 parodies of prose styles, tracing the embryonic development of English from pagan incantations through great writers like Milton and Dickens to 19th century street slang. He&rsquo;s telling us, I think, that our lives are things of wonder, worthy of admiration&mdash;not <em>even</em> in the everyday, but <em>especially</em> in the everyday.
                    </p>
                    <p>
                        Joyce&rsquo;s appreciation differs from Huxley&rsquo;s, and at first the comparison seems odd: Huxley marvels at the existence of objects; Joyce at the richness of human experience. But both encourage us to take a step back and observe, and both suggest that what we dismiss as &ldquo;mere things&rdquo; or mundane moments might be all we really have.
                    </p>
                </div>
                <div class="margin-note" id="margin-1">
                    <div class="margin-note-label">Istigkeit</div>
                    German for &ldquo;is-ness&rdquo; or &ldquo;suchness&rdquo;&mdash;a term from the medieval mystic Meister Eckhart. Huxley borrows it to describe the raw, unmediated experience of things as they simply <em>are</em>.
                </div>
                <div class="margin-note" id="margin-3">
                    <div class="margin-note-label">Epiphany</div>
                    Joyce&rsquo;s use of the word goes beyond its religious sense. For him, an epiphany is a moment when the essence of a thing reveals itself through the most commonplace encounters.
                </div>
            </article>

            <div class="site-footer">
                &copy; 2026 Notes in the Margins
            </div>
        </main>

        <!-- Right column -->
        <div class="right-column">
            <div class="reading-indicator" id="readingIndicator">
                <div class="reading-indicator-label">Currently reading</div>
                <div class="reading-indicator-title" id="indicatorTitle"></div>
                <div class="reading-indicator-progress">
                    <div class="reading-indicator-bar" id="indicatorBar"></div>
                </div>
            </div>
        </div>
    </div>

    <script data-goatcounter="https://laboursoflove.goatcounter.com/count"
            async src="//gc.zgo.at/count.js"></script>

    <script>
        const isMobile = () => window.innerWidth <= 1200;
        let activePopup = null;
        let popupTimer = null;

        // ── Position margin notes (desktop) ──
        function positionMarginNotes() {
            if (isMobile()) return;

            document.querySelectorAll('.annotated').forEach(span => {
                const note = document.getElementById(span.dataset.margin);
                if (!note) return;

                const entry = span.closest('.entry');
                const spanRect = span.getBoundingClientRect();
                const entryRect = entry.getBoundingClientRect();
                note.style.top = `${spanRect.top - entryRect.top}px`;
            });
        }

        // ── Close any open popup ──
        function closeActivePopup() {
            if (popupTimer) { clearTimeout(popupTimer); popupTimer = null; }
            if (activePopup) {
                activePopup.classList.remove('show');
                setTimeout(() => {
                    if (activePopup && !activePopup.classList.contains('show')) {
                        activePopup.remove();
                    }
                    activePopup = null;
                }, 250);
            }
        }

        // ── Create and show a popup for an annotated span ──
        function showPopup(span) {
            closeActivePopup();

            const marginId = span.dataset.margin;
            const note = document.getElementById(marginId);
            if (!note) return;

            const label = note.querySelector('.margin-note-label');
            const labelText = label ? label.textContent : '';
            // Get the note text content without the label
            const noteClone = note.cloneNode(true);
            const cloneLabel = noteClone.querySelector('.margin-note-label');
            if (cloneLabel) cloneLabel.remove();
            const noteText = noteClone.innerHTML.trim();

            const popup = document.createElement('div');
            popup.className = 'note-popup';
            popup.innerHTML = `<div class="note-popup-label">${labelText}</div>${noteText}`;

            span.style.position = 'relative';
            span.appendChild(popup);

            // Check if popup would be cut off at top
            const spanRect = span.getBoundingClientRect();
            if (spanRect.top < 300) {
                popup.classList.add('below');
            }

            // Trigger show and clamp to viewport edges
            requestAnimationFrame(() => {
                popup.classList.add('show');

                // Prevent popup from overflowing left/right edges
                const popupRect = popup.getBoundingClientRect();
                const pad = 12;
                if (popupRect.left < pad) {
                    const shift = pad - popupRect.left;
                    popup.style.left = `calc(50% + ${shift}px)`;
                } else if (popupRect.right > window.innerWidth - pad) {
                    const shift = popupRect.right - (window.innerWidth - pad);
                    popup.style.left = `calc(50% - ${shift}px)`;
                }
            });

            activePopup = popup;

            // Auto-dismiss after 4 seconds on mobile
            if (popupTimer) clearTimeout(popupTimer);
            popupTimer = setTimeout(() => {
                if (activePopup === popup) closeActivePopup();
            }, 4000);

            // Tapping the popup itself closes it on mobile
            popup.addEventListener('click', () => closeActivePopup());
        }

        // ── Margin note hover (desktop) ──
        function initDesktopHover() {
            document.querySelectorAll('.annotated').forEach(span => {
                const note = document.getElementById(span.dataset.margin);
                if (!note) return;

                span.addEventListener('mouseenter', () => {
                    if (isMobile()) return;
                    note.classList.add('visible');
                });

                span.addEventListener('mouseleave', () => {
                    if (isMobile()) return;
                    setTimeout(() => {
                        if (!note.matches(':hover')) note.classList.remove('visible');
                    }, 120);
                });

                note.addEventListener('mouseleave', () => note.classList.remove('visible'));
            });
        }

        // ── Click handler for annotations (mobile only) ──
        function initAnnotationClicks() {
            document.querySelectorAll('.annotated').forEach(span => {
                span.addEventListener('click', (e) => {
                    if (!isMobile()) return; // Desktop uses margin note hover instead
                    e.stopPropagation();

                    // If this span already has the active popup, close it
                    if (activePopup && span.contains(activePopup)) {
                        closeActivePopup();
                        return;
                    }

                    showPopup(span);
                });
            });

            // Close popup when clicking elsewhere (on mobile, tapping popup also closes it)
            document.addEventListener('click', (e) => {
                if (!activePopup) return;
                if (e.target.closest('.annotated')) return; // let the span handler deal with it
                closeActivePopup();
            });
        }

        // ── About toggle (mobile) ──
        document.getElementById('aboutToggle').addEventListener('click', () => {
            const toggle = document.getElementById('aboutToggle');
            const body = document.getElementById('aboutBody');
            toggle.classList.toggle('open');
            body.classList.toggle('open');
        });

        // ── Reading progress ──
        function updateProgress() {
            const scrollTop = window.scrollY;
            const docHeight = document.documentElement.scrollHeight - window.innerHeight;
            const progress = docHeight > 0 ? (scrollTop / docHeight) * 100 : 0;
            document.getElementById('readingProgress').style.width = `${progress}%`;
        }

        // ── Shareable entry links ──
        function initShareableLinks() {
            document.querySelectorAll('.entry-title').forEach(title => {
                const entry = title.closest('.entry');
                if (!entry || !entry.id) return;

                title.addEventListener('click', () => {
                    const url = `${window.location.origin}${window.location.pathname}#${entry.id}`;
                    navigator.clipboard.writeText(url).then(() => {
                        if (isMobile()) {
                            // Mobile: fixed toast at bottom of viewport
                            let toast = document.getElementById('copy-toast');
                            if (!toast) {
                                toast = document.createElement('span');
                                toast.id = 'copy-toast';
                                toast.className = 'link-toast';
                                toast.textContent = 'link copied';
                                document.body.appendChild(toast);
                            }
                            toast.classList.add('show');
                            setTimeout(() => toast.classList.remove('show'), 1800);
                        } else {
                            // Desktop: subtle tooltip in left margin
                            let tooltip = title.querySelector('.link-tooltip');
                            if (!tooltip) {
                                tooltip = document.createElement('span');
                                tooltip.className = 'link-tooltip';
                                tooltip.textContent = 'link copied';
                                title.appendChild(tooltip);
                            }
                            tooltip.classList.add('show');
                            setTimeout(() => tooltip.classList.remove('show'), 1800);
                        }
                    });
                    history.replaceState(null, '', `#${entry.id}`);
                });
            });
        }

        // ── Currently reading indicator + sidebar index active state ──
        function updateReadingIndicator() {
            if (isMobile()) return;

            const entries = document.querySelectorAll('.entry');
            const indicator = document.getElementById('readingIndicator');
            const indicatorTitle = document.getElementById('indicatorTitle');
            const indicatorBar = document.getElementById('indicatorBar');

            let currentEntry = null;
            let entryProgress = 0;

            entries.forEach((entry, i) => {
                const rect = entry.getBoundingClientRect();
                const vh = window.innerHeight;
                if (rect.top < vh * 0.4 && rect.bottom > 0) {
                    currentEntry = entry;
                    const totalHeight = rect.height;
                    const scrolledInto = Math.max(0, vh * 0.4 - rect.top);
                    entryProgress = Math.min(100, (scrolledInto / totalHeight) * 100);
                }
            });

            if (currentEntry) {
                indicator.classList.add('visible');
                const title = currentEntry.querySelector('.entry-title');
                if (title) {
                    const clone = title.cloneNode(true);
                    const tip = clone.querySelector('.link-tooltip');
                    if (tip) tip.remove();
                    indicatorTitle.textContent = clone.textContent;
                }
                indicatorBar.style.width = `${entryProgress}%`;
            } else {
                indicator.classList.remove('visible');
            }
        }

        // ── Visitor count ──
        function loadVisitorCount() {
            const el = document.getElementById('visitorCount');
            fetch('https://laboursoflove.goatcounter.com/counter/TOTAL.json')
                .then(function(r) { return r.json(); })
                .then(function(data) {
                    var count = data.count || '0';
                    count = count.replace(/\s/g, '');
                    var n = parseInt(count);
                    el.textContent = (n === 0 ? 'Welcome, first visitor' : 'This journal has been visited ' + count + ' times');
                    el.classList.add('loaded');
                })
                .catch(function() { /* fail silently */ });
        }

        // ── Subscribe form ──
        function initSubscribeForms() {
            document.querySelectorAll('.subscribe-form').forEach(function(form) {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    var input = form.querySelector('.subscribe-input');
                    var button = form.querySelector('.subscribe-button');
                    var status = form.querySelector('.subscribe-status');
                    if (!input.value.trim()) return;
                    input.disabled = true;
                    button.disabled = true;
                    button.textContent = '...';
                    status.textContent = '';
                    status.className = 'subscribe-status';
                    // Use hidden iframe to handle Google's redirect
                    var iframe = document.createElement('iframe');
                    iframe.name = 'subscribe-frame';
                    iframe.style.display = 'none';
                    document.body.appendChild(iframe);
                    form.target = 'subscribe-frame';
                    iframe.addEventListener('load', function() {
                        status.textContent = 'Thank you for subscribing.';
                        input.value = '';
                        input.disabled = false;
                        button.disabled = false;
                        button.textContent = 'Subscribe';
                        setTimeout(function() { iframe.remove(); }, 1000);
                    });
                    form.submit();
                });
            });
        }

        // ── Init ──
        window.addEventListener('load', () => {
            positionMarginNotes();
            initDesktopHover();
            initAnnotationClicks();
            initShareableLinks();
            updateReadingIndicator();
            loadVisitorCount();
            initSubscribeForms();
        });
        window.addEventListener('resize', positionMarginNotes);
        window.addEventListener('scroll', () => {
            positionMarginNotes();
            updateProgress();
            updateReadingIndicator();
        }, { passive: true });
    </script>
</body>
</html>
